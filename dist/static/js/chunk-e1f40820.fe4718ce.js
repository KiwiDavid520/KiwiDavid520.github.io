(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e1f40820"],{"0462":function(e,t,n){},"0feb":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return i}));var a=n("b775");function r(){return Object(a["a"])({url:"/sys/permission",method:"get"})}function s(e){return Object(a["a"])({url:"/sys/permission",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/sys/permission/".concat(e),method:"get"})}function c(e){return Object(a["a"])({url:"/sys/permission/".concat(e.id),method:"put",data:e})}function i(e){return Object(a["a"])({url:"/sys/permission/".concat(e),method:"delete"})}},7424:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-wrapper"},[n("el-card",[n("el-tabs",[n("el-tab-pane",{attrs:{label:"角色列表"}},[n("el-button",{staticClass:"primarybtn",attrs:{type:"primary"},on:{click:function(t){e.isShow=!0}}},[e._v("+新增角色")]),n("el-table",{attrs:{data:e.roleList,border:"","highlight-current-row":!0}},[n("el-table-column",{attrs:{label:"角色名称",prop:"name",align:"center"}}),n("el-table-column",{attrs:{label:"角色描述",prop:"description",align:"center"}}),n("el-table-column",{attrs:{label:"操作按钮",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(n){return e.assignPermission(t.row.id)}}},[e._v("分配权限")]),n("el-button",{attrs:{size:"small",type:"success"},on:{click:function(n){return e.editRole(t.row.id)}}},[e._v("编辑")]),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(n){return e.delateRole(t.row.id)}}},[e._v("删除")])]}}])})],1),n("el-row",{staticStyle:{height:"60px"},attrs:{type:"flex",justify:"center",align:"middle"}},[n("el-pagination",{attrs:{type:"flex",layout:"prev, pager, next","page-size":e.pageConfig.pagesize,total:e.total},on:{"current-change":e.currentChange}})],1)],1),n("el-tab-pane",{attrs:{label:"公司信息"}},[n("el-form",{staticStyle:{margin:"30px"}},[n("el-form-item",{attrs:{label:"公司名称"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.companyInfo.name,callback:function(t){e.$set(e.companyInfo,"name",t)},expression:"companyInfo.name"}})],1),n("el-form-item",{attrs:{label:"公司地址"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.companyInfo.companyAddress,callback:function(t){e.$set(e.companyInfo,"companyAddress",t)},expression:"companyInfo.companyAddress"}})],1),n("el-form-item",{attrs:{label:"电话号码"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.companyInfo.companyPhone,callback:function(t){e.$set(e.companyInfo,"companyPhone",t)},expression:"companyInfo.companyPhone"}})],1),n("el-form-item",{attrs:{label:"公司邮箱"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.companyInfo.mailbox,callback:function(t){e.$set(e.companyInfo,"mailbox",t)},expression:"companyInfo.mailbox"}})],1),n("el-form-item",{attrs:{label:"公司备注"}},[n("el-input",{staticStyle:{width:"400px"},attrs:{disabled:""},model:{value:e.companyInfo.remarks,callback:function(t){e.$set(e.companyInfo,"remarks",t)},expression:"companyInfo.remarks"}})],1)],1)],1)],1)],1),n("el-dialog",{attrs:{title:e.whichName,visible:e.isShow},on:{close:e.closeDialog},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addRole}},[e._v("确认")]),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.cancelAdd}},[e._v("取消")])]},proxy:!0}])},[n("el-form",{ref:"addRole",attrs:{rules:e.rules,model:e.formData}},[n("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[n("el-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"角色描述",prop:"description"}},[n("el-input",{model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1)],1),n("el-dialog",{attrs:{visible:e.isShowPermission,title:"为角色（岗位）分配权限"},on:{close:e.btnCancel},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-button",{on:{click:e.btnCancel}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.btnOk}},[e._v("确定")])],1)]},proxy:!0}])},[n("el-checkbox-group",{model:{value:e.checkedPermission,callback:function(t){e.checkedPermission=t},expression:"checkedPermission"}},e._l(e.permissionList,(function(t){return n("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)},r=[],s=n("c7eb"),o=n("1da1"),c=(n("b0c0"),n("a4d3"),n("e01a"),n("b775"));function i(e){return Object(c["a"])({url:"/company/".concat(e),method:"get"})}function l(e){return Object(c["a"])({url:"/sys/role",method:"get",params:e})}function u(e){return Object(c["a"])({url:"/sys/role",method:"post",data:e})}function m(e){return Object(c["a"])({url:"/sys/role/".concat(e),method:"GET"})}function p(e){return Object(c["a"])({url:"/sys/role/".concat(e.id),method:"put",data:e})}function d(e){return Object(c["a"])({url:"/sys/role/".concat(e),method:"delete"})}function f(e){return Object(c["a"])({url:"/sys/role/assignPrem",method:"put",data:e})}var b=n("0feb"),h={data:function(){return{companyInfo:{},pageConfig:{page:1,pagesize:5},roleList:[],total:0,isShow:!1,formData:{name:"",description:"",id:""},whichName:"新增角色",rules:{name:[{required:!0,message:"该项不能为空",trigger:"blur"}],description:[{required:!0,message:"该项不能为空",trigger:"blur"}]},isShowPermission:!1,permissionList:[],checkedPermission:[],permissionId:""}},created:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i(e.$store.state.user.userInfo.companyId);case 2:e.companyInfo=t.sent,console.log(e.companyInfo),e.getRoleList();case 5:case"end":return t.stop()}}),t)})))()},methods:{currentChange:function(e){this.pageConfig.page=e,this.getRoleList()},getRoleList:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var n,a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l(e.pageConfig);case 2:n=t.sent,a=n.rows,r=n.total,e.roleList=a,e.total=r;case 7:case"end":return t.stop()}}),t)})))()},addRole:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.addRole.validate();case 3:if("新增角色"!==e.whichName){t.next=13;break}return t.next=6,u(e.formData);case 6:e.isShow=!1,e.formData.name="",e.formData.description="",e.$message.success("添加成功"),e.getRoleList(),t.next=22;break;case 13:return t.next=15,p(e.formData);case 15:n=t.sent,console.log(n),e.isShow=!1,e.formData.name="",e.formData.description="",e.$message.success("更新成功"),e.getRoleList();case 22:t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](0),console.log(t.t0);case 27:case"end":return t.stop()}}),t,null,[[0,24]])})))()},cancelAdd:function(){this.isShow=!1,this.formData.name="",this.formData.description=""},closeDialog:function(){this.cancelAdd()},editRole:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function n(){var a;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.formData.id=e,t.whichName="编辑角色",n.next=4,m(e);case 4:a=n.sent,console.log(a),t.isShow=!0,console.log(e),t.formData.name=a.name,t.formData.description=a.description;case 10:case"end":return n.stop()}}),n)})))()},delateRole:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function n(){return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("确认删除?");case 2:return n.next=4,d(e);case 4:t.$message.success("删除成功"),1===t.roleList.length&&1!==t.pageConfig.page&&(t.pageConfig.page-=1),t.getRoleList();case 7:case"end":return n.stop()}}),n)})))()},assignPermission:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function n(){var a,r,o;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.permissionId=e,n.next=3,Object(b["d"])();case 3:return a=n.sent,n.next=6,m(e);case 6:r=n.sent,o=r.permIds,t.permissionList=a,t.checkedPermission=o,t.isShowPermission=!0;case 11:case"end":return n.stop()}}),n)})))()},btnOk:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f({id:e.permissionId,permIds:e.checkedPermission instanceof Array?e.checkedPermission:[]});case 2:e.$message.success("为角色（岗位）分配权限成功"),e.btnCancel(),e.getRoleList();case 5:case"end":return t.stop()}}),t)})))()},btnCancel:function(){this.permissionId="",this.checkedPermission=[],this.isShowPermission=!1}}},g=h,y=(n("8c07"),n("2877")),w=Object(y["a"])(g,a,r,!1,null,"68c2a7f0",null);t["default"]=w.exports},"8c07":function(e,t,n){"use strict";n("0462")}}]);